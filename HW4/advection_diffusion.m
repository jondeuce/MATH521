function advection_diffusion(a,D,N)
%ADVECTION_DIFFUSION computes and plots the solution of the advection-
%diffusion equation
%       a u' - D u" = 0 on ]0,1[
%       u(0) = 0
%       u(1) = 1
%a is a real number, D a positive number and N is the (integer) number of
%subintervals for the mesh.
%
%Example of use:
%advection_diffusion(10,1,25)

xxxyxyxyxyxyxyxxxxxxyxyxyxyxxxyxyxyxxxxx = 1/N; xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyxxxxx = N; xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx = 2; xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx = 1; xxxyxxyyxyxyxyxxxxxxyxyxyxyyxyxxyxyyxxxx = 0; xxxyxxyyxyxyxyxxxxxxyxyyyxyxxyxxyxyyxxxx = 1000;
xxxyxyxyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx = linspace(xxxyxxyyxyxyxyxxxxxxyxyxyxyyxyxxyxyyxxxx,xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx,xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyxxxxx+xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx)'; xxxyxyyyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx = xxxyxxyyxyxyxyxxxxxxyxyxyxyyxyxxyxyyxxxx*ones(xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyxxxxx-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx,xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx)/xxxyxxyyxyxyxyxxxxxxyxyyyxyxxyxxyxyyxxxx - xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx + xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx; xxxyxyyyxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx = a; xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx = D;
xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyyyxyxxxxx = xxxyxxyyxyxyxyxxxxxxyxyxyxyyxyxxyxyyxxxx.*xxxyxyyyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx;
xxxyxxyxxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx = xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx*spdiags([-xxxyxyyyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx*xxxyxyyyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx -xxxyxyyyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx],-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx:xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx,xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyxxxxx-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx,xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyxxxxx-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx)./xxxyxyxyxyxyxyxxxxxxyxyxyxyxxxyxyxyxxxxx^xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx;
xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyyyxyxxxxx(end) = xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyyyxyxxxxx(end) + xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx/xxxyxyxyxyxyxyxxxxxxyxyxyxyxxxyxyxyxxxxx^xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx; xxxyxxyxxyxyxyxxxxxxyxyxyxyxxyxxyxyxyxxx = xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyyyxyxxxxx; xxxyxxyxxyxyxxyxxxxxyxyxyxyxxyxxyxyxyxxx = xxxyxyyyxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx*spdiags([-xxxyxyyyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx xxxyxyyyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx],[-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx xxxyxxyyxyxyxyxxxxxxyxyxyxyyxyxxyxyyxxxx],xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyxxxxx-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx,xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyxxxxx-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx)/xxxyxyxyxyxyxyxxxxxxyxyxyxyxxxyxyxyxxxxx;
xxxyxxyxxyxyxxyxxxxxyxyxyxyxxyxxyxyyxxxx = xxxyxyyyxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx*spdiags([-xxxyxyyyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx xxxyxyyyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx],[-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx],xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyxxxxx-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx,xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyxxxxx-xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx)/(xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx*xxxyxyxyxyxyxyxxxxxxyxyxyxyxxxyxyxyxxxxx);
xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyyyxyxxxxx(end) = xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyyyxyxxxxx(end) - xxxyxyyyxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx/(xxxyxyxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx*xxxyxyxyxyxyxyxxxxxxyxyxyxyxxxyxyxyxxxxx); xxxyxxxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx = linspace(xxxyxxyyxyxyxyxxxxxxyxyxyxyyxyxxyxyyxxxx,xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx,xxxyxxyyxyxyxyxxxxxxyxyyyxyxxyxxyxyyxxxx); xxxyxxxyxyxyxyxxxxxxyxyxyxyxyxxxyxyyxxxx = (exp(xxxyxyyyxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx/xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx*xxxyxxxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx) - xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx)/(exp(xxxyxyyyxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx/xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyxyxyxxxxx) - xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx);
figure;
plot(xxxyxyxyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx,[xxxyxxyyxyxyxyxxxxxxyxyxyxyyxyxxyxyyxxxx;(xxxyxxyxxyxyxxyxxxxxyxyxyxyxxyxxyxyxyxxx+xxxyxxyxxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx)\xxxyxxyxxyxyxyxxxxxxyxyxyxyxxyxxyxyxyxxx;xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx],'o-',xxxyxyxyxyxyxyxxxxxxyxyyxxyxxxyxyxyxxxxx,[xxxyxxyyxyxyxyxxxxxxyxyxyxyyxyxxyxyyxxxx;(xxxyxxyxxyxyxxyxxxxxyxyxyxyxxyxxyxyyxxxx+xxxyxxyxxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx)\xxxyxyyxxyxyxyxxxxxyxxyyxxyxxxyyyxyxxxxx;xxxyxxyyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx],'s-',xxxyxxxyxyxyxyxxxxxxyxyxyxyxxyxxyxyyxxxx,xxxyxxxyxyxyxyxxxxxxyxyxyxyxyxxxyxyyxxxx);
xlabel('{\itx}')
ylabel('{\itu}')
legend('upwind differencing','central differencing','analytical solution','location','northwest');